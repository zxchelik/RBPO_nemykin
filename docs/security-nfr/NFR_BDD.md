Функционал: Безопасность аутентификации

  Сценарий: Пароли хранятся безопасно
    Допустим новый пользователь регистрируется в системе
    Когда происходит хеширование пароля
    Тогда пароль должен быть сохранён с использованием Argon2id с параметрами time_cost >= 3 и memory_cost >= 64 МБ

  Сценарий: JWT-токен истекает в течение 60 минут
    Допустим пользователь успешно вошёл в систему
    Когда выдан токен доступа
    Тогда время жизни токена не должно превышать 3600 секунд

  Сценарий: Все соединения защищены HTTPS
    Допустим система развернута в продуктивной среде
    Когда любой пользователь обращается к API по HTTP
    Тогда система должна перенаправить запрос на HTTPS

  Сценарий: Негативный — истёкший токен
    Допустим у пользователя есть токен старше 60 минут
    Когда он пытается обратиться к защищённому ресурсу
    Тогда API должно вернуть ошибку 401 Unauthorized

  Сценарий: Негативный — превышение лимита запросов
    Допустим клиент отправляет более 100 запросов в секунду с одного IP
    Когда система фиксирует превышение лимита
    Тогда она должна вернуть ответ 429 Too Many Requests
